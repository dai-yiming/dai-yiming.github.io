
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pandas Guide</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SciPy Guide" href="scipy_guide.html" />
    <link rel="prev" title="MATLAB for Finance" href="matlab_finance.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="ml-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Docs
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tools/index.html">
  Tools
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dai-yiming" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.linkedin.com/in/yimingdai/" rel="noopener" target="_blank" title="LinkedIn">
            <span><i class="fab fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs .." aria-label="Search the docs .." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_guide.html">
   Numpy Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_exercise.html">
   Numpy Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matlab_guide.html">
   MATLAB Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matlab_finance.html">
   MATLAB for Finance
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   pandas Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scipy_guide.html">
   SciPy Guide
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#object-creation">
   Object creation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viewing-data">
   Viewing data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selection">
   Selection
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting">
     Getting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selection-by-label">
     Selection by label
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selection-by-position">
     Selection by position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boolean-indexing">
     Boolean indexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting">
     Setting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-data">
   Missing data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operations">
   Operations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stats">
     Stats
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#apply">
     Apply
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-methods">
     String Methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge">
   Merge
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concat">
     Concat
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#join">
     Join
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping">
   Grouping
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reshaping">
   Reshaping
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stack">
     Stack
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivot-tables">
     Pivot tables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-series">
   Time series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#categoricals">
   Categoricals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   Plotting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#io-management">
   IO Management
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv">
     CSV
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hdf5">
     HDF5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#excel">
     Excel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#miscellaneous">
   Miscellaneous
  </a>
 </li>
</ul>

</nav>
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="pandas-guide">
<span id="id1"></span><h1>pandas Guide<a class="headerlink" href="#pandas-guide" title="Permalink to this headline">¶</a></h1>
<p>This is an elegant-design introduction to pandas, geared mainly for new users. You can see more complex recipes at <a class="reference external" href="https://pandas.pydata.org/docs/index.html">pandas</a>.  Note that this introduction refers to the official documentation, so pandas has copyright to part of the content. The author enhances by adding more detailed examples and explanations for easier comprehension.</p>
<p>Customarily, we import as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<div class="section" id="object-creation">
<h2>Object creation<a class="headerlink" href="#object-creation" title="Permalink to this headline">¶</a></h2>
<p>Creating a <code class="docutils literal notranslate"><span class="pre">Series</span></code> by passing a list of values, letting pandas create a default integer index:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]);</span> <span class="n">s</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">0    1.0</span>
<span class="go">1    3.0</span>
<span class="go">2    5.0</span>
<span class="go">3    NaN</span>
<span class="go">4    6.0</span>
<span class="go">5    8.0</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Creating a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by passing a Numpy array, with a datetime index and labeled columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;20210801&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">dates</span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">DatetimeIndex([&#39;2021-08-01&#39;, &#39;2021-08-02&#39;, &#39;2021-08-03&#39;, &#39;2021-08-04&#39;,</span>
<span class="go">               &#39;2021-08-05&#39;, &#39;2021-08-06&#39;],</span>
<span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>

<span class="gp">In [6]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCD&quot;</span><span class="p">))</span>

<span class="gp">In [7]: </span><span class="n">df</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-01  0.217120  0.353121 -0.551206  0.840941</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040 -0.548415</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  0.673164</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844 -0.652033</span>
<span class="go">2021-08-05 -0.177799  0.023023  1.535067 -0.051603</span>
<span class="go">2021-08-06 -0.070985  0.068657 -0.068792 -1.131507</span>
</pre></div>
</div>
<p>Creating a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by passing a dict of objects that can be converted to series-like:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="p">{</span>
<span class="gp">   ...: </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="gp">   ...: </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;20210801&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int64&quot;</span><span class="p">),</span>
<span class="gp">   ...: </span>        <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">]),</span>
<span class="gp">   ...: </span>        <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="p">}</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [9]: </span><span class="n">df2</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">     A          B    C  D      E    F</span>
<span class="go">0  4.0 2021-08-01  1.0  3   test  cat</span>
<span class="go">1  4.0 2021-08-01  1.0  3  train  cat</span>
<span class="go">2  4.0 2021-08-01  1.0  3   test  cat</span>
<span class="go">3  4.0 2021-08-01  1.0  3  train  cat</span>
</pre></div>
</div>
<p>The columns of the resulting <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> have different dtypes:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">df2</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[10]: </span><span class="go"></span>
<span class="go">A           float64</span>
<span class="go">B    datetime64[ns]</span>
<span class="go">C           float64</span>
<span class="go">D             int64</span>
<span class="go">E          category</span>
<span class="go">F            object</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>or the data type for a specific column:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">df2</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span>
<span class="gh">Out[11]: </span><span class="go">dtype(&#39;float64&#39;)</span>
</pre></div>
</div>
<p>If you’re using IPython, tab completion for public attributes is automatically enabled. Here’s a subset of the attributes that will be completed:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">df2</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>  <span class="c1"># noqa: E225, E999</span>
<span class="go">df2.A                  df2.bool</span>
<span class="go">df2.abs                df2.boxplot</span>
<span class="go">df2.add                df2.C</span>
<span class="go">df2.add_prefix         df2.clip</span>
<span class="go">df2.add_suffix         df2.columns</span>
<span class="go">df2.align              df2.copy</span>
<span class="go">df2.all                df2.count</span>
<span class="go">df2.any                df2.combine</span>
<span class="go">df2.append             df2.D</span>
<span class="go">df2.apply              df2.describe</span>
<span class="go">df2.applymap           df2.diff</span>
<span class="go">df2.B                  df2.duplicated</span>
</pre></div>
</div>
<p>Display the shape, dimension:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="gh">Out[13]: </span><span class="go">(6, 4)</span>

<span class="gp">In [14]: </span><span class="n">df</span><span class="o">.</span><span class="n">ndim</span>
<span class="gh">Out[14]: </span><span class="go">2</span>
</pre></div>
</div>
</div>
<div class="section" id="viewing-data">
<h2>Viewing data<a class="headerlink" href="#viewing-data" title="Permalink to this headline">¶</a></h2>
<p>Here is how to view the top and bottom rows of the frame:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[15]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-01  0.217120  0.353121 -0.551206  0.840941</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040 -0.548415</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  0.673164</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844 -0.652033</span>
<span class="go">2021-08-05 -0.177799  0.023023  1.535067 -0.051603</span>

<span class="gp">In [16]: </span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844 -0.652033</span>
<span class="go">2021-08-05 -0.177799  0.023023  1.535067 -0.051603</span>
<span class="go">2021-08-06 -0.070985  0.068657 -0.068792 -1.131507</span>
</pre></div>
</div>
<p>Display the index, columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">DatetimeIndex([&#39;2021-08-01&#39;, &#39;2021-08-02&#39;, &#39;2021-08-03&#39;, &#39;2021-08-04&#39;,</span>
<span class="go">               &#39;2021-08-05&#39;, &#39;2021-08-06&#39;],</span>
<span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>

<span class="gp">In [18]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="gh">Out[18]: </span><span class="go">Index([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame.to_numpy</span></code> gives a Numpy representation of the underlying data.Note that this can be an expensive operation when your <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> has columns with different data types, which comes down to a fundamental difference between pandas and Numpy: <strong>Numpy arrays have one dtype for the entire array, while pandas DataFrames have one dtype per column</strong>. When you call <code class="docutils literal notranslate"><span class="pre">DataFrame.to_numpy</span></code>, pandas will find the Numpy dtype that can hold <strong>all</strong> of the dtypes in the DataFrame. This may end up being <code class="docutils literal notranslate"><span class="pre">object</span></code>, which requires casting every value to a Python object.</p>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">df</span></code>, our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> of all floating-point values, <code class="docutils literal notranslate"><span class="pre">DataFrame.to_numpy</span></code> is fast and doesn’t require copying data.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="gh">Out[19]: </span><span class="go"></span>
<span class="go">array([[ 0.2171,  0.3531, -0.5512,  0.8409],</span>
<span class="go">       [ 0.1512,  1.1551,  0.077 , -0.5484],</span>
<span class="go">       [-0.2394,  0.9977, -1.0066,  0.6732],</span>
<span class="go">       [-0.6405,  0.2193,  0.6068, -0.652 ],</span>
<span class="go">       [-0.1778,  0.023 ,  1.5351, -0.0516],</span>
<span class="go">       [-0.071 ,  0.0687, -0.0688, -1.1315]])</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">df2</span></code>, the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with multiple dtypes, <code class="docutils literal notranslate"><span class="pre">DataFrame.to_numpy</span></code> is relatively expensive.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">df2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">array([[4.0, Timestamp(&#39;2021-08-01 00:00:00&#39;), 1.0, 3, &#39;test&#39;, &#39;cat&#39;],</span>
<span class="go">       [4.0, Timestamp(&#39;2021-08-01 00:00:00&#39;), 1.0, 3, &#39;train&#39;, &#39;cat&#39;],</span>
<span class="go">       [4.0, Timestamp(&#39;2021-08-01 00:00:00&#39;), 1.0, 3, &#39;test&#39;, &#39;cat&#39;],</span>
<span class="go">       [4.0, Timestamp(&#39;2021-08-01 00:00:00&#39;), 1.0, 3, &#39;train&#39;, &#39;cat&#39;]],</span>
<span class="go">      dtype=object)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame.to_numpy</span></code> does not include the index or column labels in the output.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame.describe</span></code> shows a quick statistic summary of your data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gh">Out[21]: </span><span class="go"></span>
<span class="go">              A         B         C         D</span>
<span class="go">count  6.000000  6.000000  6.000000  6.000000</span>
<span class="go">mean  -0.126725  0.469477  0.098732 -0.144909</span>
<span class="go">std    0.309144  0.486873  0.893740  0.780156</span>
<span class="go">min   -0.640489  0.023023 -1.006559 -1.131507</span>
<span class="go">25%   -0.224012  0.106308 -0.430602 -0.626129</span>
<span class="go">50%   -0.124392  0.286192  0.004124 -0.300009</span>
<span class="go">75%    0.095669  0.836547  0.474393  0.491972</span>
<span class="go">max    0.217120  1.155111  1.535067  0.840941</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DateFrame.info</span></code> show information about dataset</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="go">DatetimeIndex: 6 entries, 2021-08-01 to 2021-08-06</span>
<span class="go">Freq: D</span>
<span class="go">Data columns (total 4 columns):</span>
<span class="go"> #   Column  Non-Null Count  Dtype  </span>
<span class="go">---  ------  --------------  -----  </span>
<span class="go"> 0   A       6 non-null      float64</span>
<span class="go"> 1   B       6 non-null      float64</span>
<span class="go"> 2   C       6 non-null      float64</span>
<span class="go"> 3   D       6 non-null      float64</span>
<span class="go">dtypes: float64(4)</span>
<span class="go">memory usage: 240.0 bytes</span>
</pre></div>
</div>
<p>Locate and aggregate NaN values column-wise:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[23]: </span><span class="go"></span>
<span class="go">A    0</span>
<span class="go">B    0</span>
<span class="go">C    0</span>
<span class="go">D    0</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
<p>Transposing your data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">df</span><span class="o">.</span><span class="n">T</span>
<span class="gh">Out[24]: </span><span class="go"></span>
<span class="go">   2021-08-01  2021-08-02  2021-08-03  2021-08-04  2021-08-05  2021-08-06</span>
<span class="go">A    0.217120    0.151220   -0.239416   -0.640489   -0.177799   -0.070985</span>
<span class="go">B    0.353121    1.155111    0.997688    0.219262    0.023023    0.068657</span>
<span class="go">C   -0.551206    0.077040   -1.006559    0.606844    1.535067   -0.068792</span>
<span class="go">D    0.840941   -0.548415    0.673164   -0.652033   -0.051603   -1.131507</span>
</pre></div>
</div>
<p>Sorting by an axis:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[25]: </span><span class="go"></span>
<span class="go">                   D         C         B         A</span>
<span class="go">2021-08-01  0.840941 -0.551206  0.353121  0.217120</span>
<span class="go">2021-08-02 -0.548415  0.077040  1.155111  0.151220</span>
<span class="go">2021-08-03  0.673164 -1.006559  0.997688 -0.239416</span>
<span class="go">2021-08-04 -0.652033  0.606844  0.219262 -0.640489</span>
<span class="go">2021-08-05 -0.051603  1.535067  0.023023 -0.177799</span>
<span class="go">2021-08-06 -1.131507 -0.068792  0.068657 -0.070985</span>
</pre></div>
</div>
<p>Sorting by values:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="gh">Out[26]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-05 -0.177799  0.023023  1.535067 -0.051603</span>
<span class="go">2021-08-06 -0.070985  0.068657 -0.068792 -1.131507</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844 -0.652033</span>
<span class="go">2021-08-01  0.217120  0.353121 -0.551206  0.840941</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  0.673164</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040 -0.548415</span>
</pre></div>
</div>
</div>
<div class="section" id="selection">
<h2>Selection<a class="headerlink" href="#selection" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While standard Python / Numpy expressions for selecting and setting are intuitive and come in handy for interactive work, for production code, we recommend the optimized pandas data access methods, <code class="docutils literal notranslate"><span class="pre">.at</span></code>, <code class="docutils literal notranslate"><span class="pre">.iat</span></code>, <code class="docutils literal notranslate"><span class="pre">.loc</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>.</p>
</div>
<div class="section" id="getting">
<h3>Getting<a class="headerlink" href="#getting" title="Permalink to this headline">¶</a></h3>
<p>Selecting a single column, which yields a <code class="docutils literal notranslate"><span class="pre">Series</span></code>, equivalent to <code class="docutils literal notranslate"><span class="pre">df.A</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="gh">Out[27]: </span><span class="go"></span>
<span class="go">2021-08-01    0.217120</span>
<span class="go">2021-08-02    0.151220</span>
<span class="go">2021-08-03   -0.239416</span>
<span class="go">2021-08-04   -0.640489</span>
<span class="go">2021-08-05   -0.177799</span>
<span class="go">2021-08-06   -0.070985</span>
<span class="go">Freq: D, Name: A, dtype: float64</span>
</pre></div>
</div>
<p>Selecting via <code class="docutils literal notranslate"><span class="pre">[]</span></code>, which slices the rows.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gh">Out[28]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-01  0.217120  0.353121 -0.551206  0.840941</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040 -0.548415</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  0.673164</span>

<span class="gp">In [29]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;20210802&quot;</span><span class="p">:</span><span class="s2">&quot;20210804&quot;</span><span class="p">]</span>
<span class="gh">Out[29]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040 -0.548415</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  0.673164</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844 -0.652033</span>
</pre></div>
</div>
</div>
<div class="section" id="selection-by-label">
<h3>Selection by label<a class="headerlink" href="#selection-by-label" title="Permalink to this headline">¶</a></h3>
<p>For getting a cross section using a label:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gh">Out[30]: </span><span class="go"></span>
<span class="go">A    0.217120</span>
<span class="go">B    0.353121</span>
<span class="go">C   -0.551206</span>
<span class="go">D    0.840941</span>
<span class="go">Name: 2021-08-01 00:00:00, dtype: float64</span>
</pre></div>
</div>
<p>Selecting on a multi-axis by label:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [31]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]]</span>
<span class="gh">Out[31]: </span><span class="go"></span>
<span class="go">                   A         B</span>
<span class="go">2021-08-01  0.217120  0.353121</span>
<span class="go">2021-08-02  0.151220  1.155111</span>
<span class="go">2021-08-03 -0.239416  0.997688</span>
<span class="go">2021-08-04 -0.640489  0.219262</span>
<span class="go">2021-08-05 -0.177799  0.023023</span>
<span class="go">2021-08-06 -0.070985  0.068657</span>
</pre></div>
</div>
<p>Showing label slicing, both endpoints are <em>included</em>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;20210802&quot;</span><span class="p">:</span><span class="s2">&quot;20210804&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]]</span>
<span class="gh">Out[32]: </span><span class="go"></span>
<span class="go">                   A         B</span>
<span class="go">2021-08-02  0.151220  1.155111</span>
<span class="go">2021-08-03 -0.239416  0.997688</span>
<span class="go">2021-08-04 -0.640489  0.219262</span>
</pre></div>
</div>
<p>Reduction in the dimensions of the returned object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [33]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;20210802&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]]</span>
<span class="gh">Out[33]: </span><span class="go"></span>
<span class="go">A    0.151220</span>
<span class="go">B    1.155111</span>
<span class="go">Name: 2021-08-02 00:00:00, dtype: float64</span>
</pre></div>
</div>
<p>For getting a scalar value:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="gh">Out[34]: </span><span class="go">0.21712016704323</span>
</pre></div>
</div>
<p>For getting fast access to a scalar (equivalent to the prior method):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="gh">Out[35]: </span><span class="go">0.21712016704323</span>
</pre></div>
</div>
</div>
<div class="section" id="selection-by-position">
<h3>Selection by position<a class="headerlink" href="#selection-by-position" title="Permalink to this headline">¶</a></h3>
<p>Select via the position of the passed integers:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [36]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gh">Out[36]: </span><span class="go"></span>
<span class="go">A   -0.640489</span>
<span class="go">B    0.219262</span>
<span class="go">C    0.606844</span>
<span class="go">D   -0.652033</span>
<span class="go">Name: 2021-08-04 00:00:00, dtype: float64</span>
</pre></div>
</div>
<p>By integer slices, acting similar to Numpy/Python:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [37]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gh">Out[37]: </span><span class="go"></span>
<span class="go">                   A         B</span>
<span class="go">2021-08-04 -0.640489  0.219262</span>
<span class="go">2021-08-05 -0.177799  0.023023</span>
</pre></div>
</div>
<p>By lists of integer position locations, similar to the Numpy/Python style:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gh">Out[38]: </span><span class="go"></span>
<span class="go">                   A         C</span>
<span class="go">2021-08-02  0.151220  0.077040</span>
<span class="go">2021-08-03 -0.239416 -1.006559</span>
<span class="go">2021-08-05 -0.177799  1.535067</span>
</pre></div>
</div>
<p>For slicing rows explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
<span class="gh">Out[39]: </span><span class="go"></span>
<span class="go">                   A         B         C         D</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040 -0.548415</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  0.673164</span>
</pre></div>
</div>
<p>For slicing columns explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [40]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gh">Out[40]: </span><span class="go"></span>
<span class="go">                   B         C</span>
<span class="go">2021-08-01  0.353121 -0.551206</span>
<span class="go">2021-08-02  1.155111  0.077040</span>
<span class="go">2021-08-03  0.997688 -1.006559</span>
<span class="go">2021-08-04  0.219262  0.606844</span>
<span class="go">2021-08-05  0.023023  1.535067</span>
<span class="go">2021-08-06  0.068657 -0.068792</span>
</pre></div>
</div>
<p>For getting a value explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gh">Out[41]: </span><span class="go">1.1551105853091492</span>
</pre></div>
</div>
<p>For getting fast access to a scalar (equivalent to the prior method):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gh">Out[42]: </span><span class="go">1.1551105853091492</span>
</pre></div>
</div>
</div>
<div class="section" id="boolean-indexing">
<h3>Boolean indexing<a class="headerlink" href="#boolean-indexing" title="Permalink to this headline">¶</a></h3>
<p>Using a single column’s values to select data.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[43]: </span><span class="go"></span>
<span class="go">                  A         B         C         D</span>
<span class="go">2021-08-01  0.21712  0.353121 -0.551206  0.840941</span>
<span class="go">2021-08-02  0.15122  1.155111  0.077040 -0.548415</span>
</pre></div>
</div>
<p>Selecting values from a DataFrame where a boolean condition is met.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [44]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[44]: </span><span class="go"></span>
<span class="go">                  A         B         C         D</span>
<span class="go">2021-08-01  0.21712  0.353121       NaN  0.840941</span>
<span class="go">2021-08-02  0.15122  1.155111  0.077040       NaN</span>
<span class="go">2021-08-03      NaN  0.997688       NaN  0.673164</span>
<span class="go">2021-08-04      NaN  0.219262  0.606844       NaN</span>
<span class="go">2021-08-05      NaN  0.023023  1.535067       NaN</span>
<span class="go">2021-08-06      NaN  0.068657       NaN       NaN</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">Series.isin</span></code> method for filtering:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;test&quot;</span><span class="p">])]</span>
<span class="gh">Out[45]: </span><span class="go"></span>
<span class="go">     A          B    C  D     E    F</span>
<span class="go">0  4.0 2021-08-01  1.0  3  test  cat</span>
<span class="go">2  4.0 2021-08-01  1.0  3  test  cat</span>
</pre></div>
</div>
</div>
<div class="section" id="setting">
<h3>Setting<a class="headerlink" href="#setting" title="Permalink to this headline">¶</a></h3>
<p>Setting a new column automatically aligns the data by the indexes.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;20210801&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>

<span class="gp">In [47]: </span><span class="n">s1</span>
<span class="gh">Out[47]: </span><span class="go"></span>
<span class="go">2021-08-01    1</span>
<span class="go">2021-08-02    2</span>
<span class="go">2021-08-03    3</span>
<span class="go">2021-08-04    4</span>
<span class="go">2021-08-05    5</span>
<span class="go">2021-08-06    6</span>
<span class="go">Freq: D, dtype: int64</span>

<span class="gp">In [48]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span>
</pre></div>
</div>
<p>Setting values by label:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [49]: </span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Setting values by position:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Setting by assigning with a Numpy array:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [51]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;D&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
<p>The result of the prior setting operations.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [52]: </span><span class="n">df</span>
<span class="gh">Out[52]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6  1</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040  6  2</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  6  3</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6  4</span>
<span class="go">2021-08-05 -0.177799  0.023023  1.535067  6  5</span>
<span class="go">2021-08-06 -0.070985  0.068657 -0.068792  6  6</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">where</span></code> operation with setting.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [54]: </span><span class="n">df2</span><span class="p">[</span><span class="n">df2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">df2</span>

<span class="gp">In [55]: </span><span class="n">df2</span>
<span class="gh">Out[55]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206 -6 -1</span>
<span class="go">2021-08-02 -0.151220 -1.155111 -0.077040 -6 -2</span>
<span class="go">2021-08-03 -0.239416 -0.997688 -1.006559 -6 -3</span>
<span class="go">2021-08-04 -0.640489 -0.219262 -0.606844 -6 -4</span>
<span class="go">2021-08-05 -0.177799 -0.023023 -1.535067 -6 -5</span>
<span class="go">2021-08-06 -0.070985 -0.068657 -0.068792 -6 -6</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="missing-data">
<h2>Missing data<a class="headerlink" href="#missing-data" title="Permalink to this headline">¶</a></h2>
<p>pandas primarily uses the value <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> to represent missing data. It is by default not included in computations.</p>
<p>Reindexing allows you to change/add/delete the index on a specified axis. This returns a copy of the data.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [56]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">])</span>

<span class="gp">In [57]: </span><span class="n">df1</span>
<span class="gh">Out[57]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F   E</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6  1 NaN</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040  6  2 NaN</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  6  3 NaN</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6  4 NaN</span>

<span class="gp">In [58]: </span><span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">dates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;E&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="gp">In [59]: </span><span class="n">df1</span>
<span class="gh">Out[59]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F    E</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6  1  1.0</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040  6  2  1.0</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  6  3  NaN</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6  4  NaN</span>
</pre></div>
</div>
<p>To drop any rows that have missing data.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="n">df1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
<span class="gh">Out[60]: </span><span class="go"></span>
<span class="go">                  A         B         C  D  F    E</span>
<span class="go">2021-08-01  0.00000  0.000000 -0.551206  6  1  1.0</span>
<span class="go">2021-08-02  0.15122  1.155111  0.077040  6  2  1.0</span>
</pre></div>
</div>
<p>To get the boolean mask where values are <code class="docutils literal notranslate"><span class="pre">nan</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [61]: </span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="gh">Out[61]: </span><span class="go"></span>
<span class="go">                A      B      C      D      F      E</span>
<span class="go">2021-08-01  False  False  False  False  False  False</span>
<span class="go">2021-08-02  False  False  False  False  False  False</span>
<span class="go">2021-08-03  False  False  False  False  False   True</span>
<span class="go">2021-08-04  False  False  False  False  False   True</span>
</pre></div>
</div>
<p>Filling missing data with closest previous valid value.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [62]: </span><span class="n">df1</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [63]: </span><span class="n">df1</span>
<span class="gh">Out[63]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F    E</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6  1  1.0</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040  6  2  1.0</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  6  3  1.0</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6  4  NaN</span>
</pre></div>
</div>
<p>Replace NaN in a column with a value.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="n">df1</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [65]: </span><span class="n">df1</span>
<span class="gh">Out[65]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F    E</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6  1  1.0</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040  6  2  1.0</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  6  3  1.0</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6  4  6.0</span>
</pre></div>
</div>
<p>Drop duplicate values in a column.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [66]: </span><span class="n">df1</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
<span class="gh">Out[66]: </span><span class="go"></span>
<span class="go">2021-08-03    1.0</span>
<span class="go">2021-08-04    6.0</span>
<span class="go">Freq: D, Name: E, dtype: float64</span>
</pre></div>
</div>
<p>Drop rows which contains a value.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [67]: </span><span class="n">df1</span><span class="p">[((</span><span class="n">df1</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df1</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="gh">Out[67]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  F    E</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6  1  1.0</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6  4  6.0</span>
</pre></div>
</div>
<p>Change certain column names.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [68]: </span><span class="n">df1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;F&quot;</span><span class="p">:</span><span class="s2">&quot;Rank&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">:</span><span class="s2">&quot;Variance&quot;</span><span class="p">})</span>
<span class="gh">Out[68]: </span><span class="go"></span>
<span class="go">                   A         B         C  D  Rank  Variance</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206  6     1       1.0</span>
<span class="go">2021-08-02  0.151220  1.155111  0.077040  6     2       1.0</span>
<span class="go">2021-08-03 -0.239416  0.997688 -1.006559  6     3       1.0</span>
<span class="go">2021-08-04 -0.640489  0.219262  0.606844  6     4       6.0</span>
</pre></div>
</div>
</div>
<div class="section" id="operations">
<h2>Operations<a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="stats">
<h3>Stats<a class="headerlink" href="#stats" title="Permalink to this headline">¶</a></h3>
<p>Operations in general <em>exclude</em> missing data.</p>
<p>Performing a descriptive statistic:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [69]: </span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gh">Out[69]: </span><span class="go"></span>
<span class="go">A   -0.162912</span>
<span class="go">B    0.410623</span>
<span class="go">C    0.098732</span>
<span class="go">D    6.000000</span>
<span class="go">F    3.500000</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Same operation on the other axis:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [70]: </span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gh">Out[70]: </span><span class="go"></span>
<span class="go">2021-08-01    1.289759</span>
<span class="go">2021-08-02    1.876674</span>
<span class="go">2021-08-03    1.750343</span>
<span class="go">2021-08-04    2.037123</span>
<span class="go">2021-08-05    2.476058</span>
<span class="go">2021-08-06    2.385776</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>Operating with objects that have different dimensionality and need alignment. In addition, pandas automatically broadcasts along the specified dimension.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [71]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [72]: </span><span class="n">s</span>
<span class="gh">Out[72]: </span><span class="go"></span>
<span class="go">2021-08-01    NaN</span>
<span class="go">2021-08-02    NaN</span>
<span class="go">2021-08-03    1.0</span>
<span class="go">2021-08-04    3.0</span>
<span class="go">2021-08-05    5.0</span>
<span class="go">2021-08-06    NaN</span>
<span class="go">Freq: D, dtype: float64</span>

<span class="gp">In [73]: </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="gh">Out[73]: </span><span class="go"></span>
<span class="go">                   A         B         C    D    F</span>
<span class="go">2021-08-01       NaN       NaN       NaN  NaN  NaN</span>
<span class="go">2021-08-02       NaN       NaN       NaN  NaN  NaN</span>
<span class="go">2021-08-03 -1.239416 -0.002312 -2.006559  5.0  2.0</span>
<span class="go">2021-08-04 -3.640489 -2.780738 -2.393156  3.0  1.0</span>
<span class="go">2021-08-05 -5.177799 -4.976977 -3.464933  1.0  0.0</span>
<span class="go">2021-08-06       NaN       NaN       NaN  NaN  NaN</span>
</pre></div>
</div>
</div>
<div class="section" id="apply">
<h3>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h3>
<p>Applying functions to the data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [74]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">)</span>
<span class="gh">Out[74]: </span><span class="go"></span>
<span class="go">                   A         B         C   D   F</span>
<span class="go">2021-08-01  0.000000  0.000000 -0.551206   6   1</span>
<span class="go">2021-08-02  0.151220  1.155111 -0.474166  12   3</span>
<span class="go">2021-08-03 -0.088196  2.152799 -1.480724  18   6</span>
<span class="go">2021-08-04 -0.728685  2.372060 -0.873880  24  10</span>
<span class="go">2021-08-05 -0.906484  2.395084  0.661187  30  15</span>
<span class="go">2021-08-06 -0.977470  2.463741  0.592395  36  21</span>

<span class="gp">In [75]: </span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="gh">Out[75]: </span><span class="go"></span>
<span class="go">A    0.791708</span>
<span class="go">B    1.155111</span>
<span class="go">C    2.541626</span>
<span class="go">D    0.000000</span>
<span class="go">F    5.000000</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="string-methods">
<h3>String Methods<a class="headerlink" href="#string-methods" title="Permalink to this headline">¶</a></h3>
<p>Series is equipped with a set of string processing methods in the <code class="docutils literal notranslate"><span class="pre">str</span></code> attribute that make it easy to operate on each element of the array, as in the code snippet below. Note that pattern-matching in <code class="docutils literal notranslate"><span class="pre">str</span></code> generally uses <a class="reference external" href="https://docs.python.org/3/library/re.html">regular expressions</a> by default (and in some cases always uses them).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [76]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;CABA&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">])</span>

<span class="gp">In [77]: </span><span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="gh">Out[77]: </span><span class="go"></span>
<span class="go">0       a</span>
<span class="go">1       b</span>
<span class="go">2       c</span>
<span class="go">3     NaN</span>
<span class="go">4    caba</span>
<span class="go">5     dog</span>
<span class="go">6     cat</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>More <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.capitalize.html">string methods</a> are provided like <code class="docutils literal notranslate"><span class="pre">str.title</span></code>, <code class="docutils literal notranslate"><span class="pre">str.capitalize</span></code>, <code class="docutils literal notranslate"><span class="pre">str.upper</span></code>.</p>
</div>
</div>
<div class="section" id="merge">
<h2>Merge<a class="headerlink" href="#merge" title="Permalink to this headline">¶</a></h2>
<div class="section" id="concat">
<h3>Concat<a class="headerlink" href="#concat" title="Permalink to this headline">¶</a></h3>
<p>pandas provides various facilities for easily combining together Series and DataFrame objects with various kinds of set logic for the indexes and relational algebra functionality in the case of join / merge-type operations.</p>
<p>Concatenating pandas objects together with <code class="docutils literal notranslate"><span class="pre">concat</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [78]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="gp">In [79]: </span><span class="n">df</span>
<span class="gh">Out[79]: </span><span class="go"></span>
<span class="go">          0         1         2         3</span>
<span class="go">0  0.066567 -0.858266  1.090977 -0.914114</span>
<span class="go">1 -0.518657 -1.252172 -0.179143 -0.780076</span>
<span class="go">2  1.593288 -0.002256  0.556972 -0.365743</span>
<span class="go">3  1.653892  0.866307  0.288360  0.609170</span>
<span class="go">4  0.942738  0.473426 -0.481780  0.217468</span>
<span class="go">5 -0.935083 -2.314436 -0.756820  0.134721</span>
<span class="go">6  1.626621 -0.189159  0.163252 -2.167390</span>
<span class="go">7  0.872637 -0.399940  1.590034 -1.410947</span>
<span class="go">8 -0.322460  2.964687  0.039817 -1.170292</span>
<span class="go">9  0.268392  0.273466 -0.074330 -1.341226</span>

<span class="gp">In [80]: </span><span class="n">pieces</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="mi">7</span><span class="p">:]]</span>

<span class="gp">In [81]: </span><span class="n">pieces</span>
<span class="gh">Out[81]: </span><span class="go"></span>
<span class="go">[          0         1         2         3</span>
<span class="go"> 0  0.066567 -0.858266  1.090977 -0.914114</span>
<span class="go"> 1 -0.518657 -1.252172 -0.179143 -0.780076</span>
<span class="go"> 2  1.593288 -0.002256  0.556972 -0.365743,</span>
<span class="go">           0         1         2         3</span>
<span class="go"> 3  1.653892  0.866307  0.288360  0.609170</span>
<span class="go"> 4  0.942738  0.473426 -0.481780  0.217468</span>
<span class="go"> 5 -0.935083 -2.314436 -0.756820  0.134721</span>
<span class="go"> 6  1.626621 -0.189159  0.163252 -2.167390,</span>
<span class="go">           0         1         2         3</span>
<span class="go"> 7  0.872637 -0.399940  1.590034 -1.410947</span>
<span class="go"> 8 -0.322460  2.964687  0.039817 -1.170292</span>
<span class="go"> 9  0.268392  0.273466 -0.074330 -1.341226]</span>

<span class="gp">In [82]: </span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
<span class="gh">Out[82]: </span><span class="go"></span>
<span class="go">          0         1         2         3</span>
<span class="go">0  0.066567 -0.858266  1.090977 -0.914114</span>
<span class="go">1 -0.518657 -1.252172 -0.179143 -0.780076</span>
<span class="go">2  1.593288 -0.002256  0.556972 -0.365743</span>
<span class="go">3  1.653892  0.866307  0.288360  0.609170</span>
<span class="go">4  0.942738  0.473426 -0.481780  0.217468</span>
<span class="go">5 -0.935083 -2.314436 -0.756820  0.134721</span>
<span class="go">6  1.626621 -0.189159  0.163252 -2.167390</span>
<span class="go">7  0.872637 -0.399940  1.590034 -1.410947</span>
<span class="go">8 -0.322460  2.964687  0.039817 -1.170292</span>
<span class="go">9  0.268392  0.273466 -0.074330 -1.341226</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding a column to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is relatively fast. However, adding
a row requires a copy, and may be expensive. We recommend passing a
pre-built list of records to the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> constructor instead
of building a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by iteratively appending records to it.</p>
</div>
</div>
<div class="section" id="join">
<h3>Join<a class="headerlink" href="#join" title="Permalink to this headline">¶</a></h3>
<p>SQL style merges:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [83]: </span><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">],</span> <span class="s2">&quot;lval&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [84]: </span><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">],</span> <span class="s2">&quot;rval&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="gp">In [85]: </span><span class="n">left</span>
<span class="gh">Out[85]: </span><span class="go"></span>
<span class="go">   key  lval</span>
<span class="go">0  foo     1</span>
<span class="go">1  foo     2</span>

<span class="gp">In [86]: </span><span class="n">right</span>
<span class="gh">Out[86]: </span><span class="go"></span>
<span class="go">   key  rval</span>
<span class="go">0  foo     4</span>
<span class="go">1  foo     5</span>

<span class="gp">In [87]: </span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
<span class="gh">Out[87]: </span><span class="go"></span>
<span class="go">   key  lval  rval</span>
<span class="go">0  foo     1     4</span>
<span class="go">1  foo     1     5</span>
<span class="go">2  foo     2     4</span>
<span class="go">3  foo     2     5</span>
</pre></div>
</div>
<p>Another example that can be given is:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [88]: </span><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">],</span> <span class="s2">&quot;lval&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [89]: </span><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">],</span> <span class="s2">&quot;rval&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="gp">In [90]: </span><span class="n">left</span>
<span class="gh">Out[90]: </span><span class="go"></span>
<span class="go">   key  lval</span>
<span class="go">0  foo     1</span>
<span class="go">1  bar     2</span>

<span class="gp">In [91]: </span><span class="n">right</span>
<span class="gh">Out[91]: </span><span class="go"></span>
<span class="go">   key  rval</span>
<span class="go">0  foo     4</span>
<span class="go">1  bar     5</span>

<span class="gp">In [92]: </span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">)</span>
<span class="gh">Out[92]: </span><span class="go"></span>
<span class="go">   key  lval  rval</span>
<span class="go">0  foo     1     4</span>
<span class="go">1  bar     2     5</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="grouping">
<h2>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¶</a></h2>
<p>By “group by” we are referring to a process involving one or more of the
following steps:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Splitting</strong> the data into groups based on some criteria</p></li>
<li><p><strong>Applying</strong> a function to each group independently</p></li>
<li><p><strong>Combining</strong> the results into a data structure</p></li>
</ul>
</div></blockquote>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [93]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="p">}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [94]: </span><span class="n">df</span>
<span class="gh">Out[94]: </span><span class="go"></span>
<span class="go">     A      B         C         D</span>
<span class="go">0  foo    one  0.073688 -0.265521</span>
<span class="go">1  bar    one  0.102749  0.035569</span>
<span class="go">2  foo    two -0.321690 -1.001309</span>
<span class="go">3  bar  three -0.551272  0.041183</span>
<span class="go">4  foo    two -1.200878 -1.352641</span>
<span class="go">5  bar    two  0.539208 -0.313030</span>
<span class="go">6  foo    one -0.656564  0.616352</span>
<span class="go">7  foo  three -0.248316 -0.504566</span>
</pre></div>
</div>
<p>Grouping and then applying the <code class="docutils literal notranslate"><span class="pre">pandas.core.groupby.GroupBy.sum</span></code> function to the resulting groups.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [95]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gh">Out[95]: </span><span class="go"></span>
<span class="go">            C         D</span>
<span class="go">A                      </span>
<span class="go">bar  0.090686 -0.236278</span>
<span class="go">foo -2.353759 -2.507686</span>
</pre></div>
</div>
<p>Grouping by multiple columns forms a hierarchical index, and again we can apply the <code class="docutils literal notranslate"><span class="pre">sum</span></code> function.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [96]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gh">Out[96]: </span><span class="go"></span>
<span class="go">                  C         D</span>
<span class="go">A   B                        </span>
<span class="go">bar one    0.102749  0.035569</span>
<span class="go">    three -0.551272  0.041183</span>
<span class="go">    two    0.539208 -0.313030</span>
<span class="go">foo one   -0.582876  0.350831</span>
<span class="go">    three -0.248316 -0.504566</span>
<span class="go">    two   -1.522568 -2.353950</span>
</pre></div>
</div>
</div>
<div class="section" id="reshaping">
<h2>Reshaping<a class="headerlink" href="#reshaping" title="Permalink to this headline">¶</a></h2>
<div class="section" id="stack">
<h3>Stack<a class="headerlink" href="#stack" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [97]: </span><span class="n">tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="nb">zip</span><span class="p">(</span>
<span class="gp">   ....: </span>        <span class="o">*</span><span class="p">[</span>
<span class="gp">   ....: </span>            <span class="p">[</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;qux&quot;</span><span class="p">,</span> <span class="s2">&quot;qux&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>            <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="p">]</span>
<span class="gp">   ....: </span>    <span class="p">)</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [98]: </span><span class="n">tuples</span>
<span class="gh">Out[98]: </span><span class="go"></span>
<span class="go">[(&#39;bar&#39;, &#39;one&#39;),</span>
<span class="go"> (&#39;bar&#39;, &#39;two&#39;),</span>
<span class="go"> (&#39;baz&#39;, &#39;one&#39;),</span>
<span class="go"> (&#39;baz&#39;, &#39;two&#39;),</span>
<span class="go"> (&#39;foo&#39;, &#39;one&#39;),</span>
<span class="go"> (&#39;foo&#39;, &#39;two&#39;),</span>
<span class="go"> (&#39;qux&#39;, &#39;one&#39;),</span>
<span class="go"> (&#39;qux&#39;, &#39;two&#39;)]</span>

<span class="gp">In [99]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">tuples</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">])</span>

<span class="gp">In [100]: </span><span class="n">index</span>
<span class="gh">Out[100]: </span><span class="go"></span>
<span class="go">MultiIndex([(&#39;bar&#39;, &#39;one&#39;),</span>
<span class="go">            (&#39;bar&#39;, &#39;two&#39;),</span>
<span class="go">            (&#39;baz&#39;, &#39;one&#39;),</span>
<span class="go">            (&#39;baz&#39;, &#39;two&#39;),</span>
<span class="go">            (&#39;foo&#39;, &#39;one&#39;),</span>
<span class="go">            (&#39;foo&#39;, &#39;two&#39;),</span>
<span class="go">            (&#39;qux&#39;, &#39;one&#39;),</span>
<span class="go">            (&#39;qux&#39;, &#39;two&#39;)],</span>
<span class="go">           names=[&#39;first&#39;, &#39;second&#39;])</span>

<span class="gp">In [101]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span>

<span class="gp">In [102]: </span><span class="n">df</span>
<span class="gh">Out[102]: </span><span class="go"></span>
<span class="go">                     A         B</span>
<span class="go">first second                    </span>
<span class="go">bar   one     0.531043 -0.467975</span>
<span class="go">      two     1.124353  0.407544</span>
<span class="go">baz   one     0.936702  0.205129</span>
<span class="go">      two     2.071065  0.258301</span>
<span class="go">foo   one     0.603384 -0.355150</span>
<span class="go">      two     0.386643  1.747663</span>
<span class="go">qux   one    -0.780664  0.198355</span>
<span class="go">      two     0.933168 -0.458800</span>

<span class="gp">In [103]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>

<span class="gp">In [104]: </span><span class="n">df2</span>
<span class="gh">Out[104]: </span><span class="go"></span>
<span class="go">                     A         B</span>
<span class="go">first second                    </span>
<span class="go">bar   one     0.531043 -0.467975</span>
<span class="go">      two     1.124353  0.407544</span>
<span class="go">baz   one     0.936702  0.205129</span>
<span class="go">      two     2.071065  0.258301</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">DataFrame.stack</span></code> method <cite>compresses</cite> a level in the DataFrame’s columns.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [105]: </span><span class="n">stacked</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

<span class="gp">In [106]: </span><span class="n">stacked</span>
<span class="gh">Out[106]: </span><span class="go"></span>
<span class="go">first  second   </span>
<span class="go">bar    one     A    0.531043</span>
<span class="go">               B   -0.467975</span>
<span class="go">       two     A    1.124353</span>
<span class="go">               B    0.407544</span>
<span class="go">baz    one     A    0.936702</span>
<span class="go">               B    0.205129</span>
<span class="go">       two     A    2.071065</span>
<span class="go">               B    0.258301</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>With a <cite>stacked</cite> DataFrame or Series (having a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> as the <code class="docutils literal notranslate"><span class="pre">index</span></code>), the inverse operation of <code class="docutils literal notranslate"><span class="pre">DataFrame.stack</span></code> is <code class="docutils literal notranslate"><span class="pre">DataFrame.unstack</span></code>, which by default unstacks the <strong>last level</strong>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [107]: </span><span class="n">stacked</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span> <span class="c1"># unstack on the last level 2</span>
<span class="gh">Out[107]: </span><span class="go"></span>
<span class="go">                     A         B</span>
<span class="go">first second                    </span>
<span class="go">bar   one     0.531043 -0.467975</span>
<span class="go">      two     1.124353  0.407544</span>
<span class="go">baz   one     0.936702  0.205129</span>
<span class="go">      two     2.071065  0.258301</span>

<span class="gp">In [108]: </span><span class="n">stacked</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gh">Out[108]: </span><span class="go"></span>
<span class="go">second        one       two</span>
<span class="go">first                      </span>
<span class="go">bar   A  0.531043  1.124353</span>
<span class="go">      B -0.467975  0.407544</span>
<span class="go">baz   A  0.936702  2.071065</span>
<span class="go">      B  0.205129  0.258301</span>

<span class="gp">In [109]: </span><span class="n">stacked</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[109]: </span><span class="go"></span>
<span class="go">first          bar       baz</span>
<span class="go">second                      </span>
<span class="go">one    A  0.531043  0.936702</span>
<span class="go">       B -0.467975  0.205129</span>
<span class="go">two    A  1.124353  2.071065</span>
<span class="go">       B  0.407544  0.258301</span>
</pre></div>
</div>
</div>
<div class="section" id="pivot-tables">
<h3>Pivot tables<a class="headerlink" href="#pivot-tables" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [110]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [111]: </span><span class="n">df</span>
<span class="gh">Out[111]: </span><span class="go"></span>
<span class="go">        A  B    C         D         E</span>
<span class="go">0     one  A  foo -1.391051  1.140861</span>
<span class="go">1     one  B  foo  0.260201 -2.452481</span>
<span class="go">2     two  C  foo -1.597497  1.239819</span>
<span class="go">3   three  A  bar  0.803946  0.227546</span>
<span class="go">4     one  B  bar  0.388702  1.576160</span>
<span class="go">..    ... ..  ...       ...       ...</span>
<span class="go">7   three  B  foo  1.362647  0.971618</span>
<span class="go">8     one  C  foo  0.860473  1.336526</span>
<span class="go">9     one  A  bar -0.517069 -2.202910</span>
<span class="go">10    two  B  bar  1.059457  0.664027</span>
<span class="go">11  three  C  bar -1.198109  1.278672</span>

<span class="go">[12 rows x 5 columns]</span>
</pre></div>
</div>
<p>We can produce pivot tables from this data very easily:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [112]: </span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="gh">Out[112]: </span><span class="go"></span>
<span class="go">C             bar       foo</span>
<span class="go">A     B                    </span>
<span class="go">one   A -0.517069 -1.391051</span>
<span class="go">      B  0.388702  0.260201</span>
<span class="go">      C -1.102630  0.860473</span>
<span class="go">three A  0.803946       NaN</span>
<span class="go">      B       NaN  1.362647</span>
<span class="go">      C -1.198109       NaN</span>
<span class="go">two   A       NaN -0.789151</span>
<span class="go">      B  1.059457       NaN</span>
<span class="go">      C       NaN -1.597497</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="time-series">
<h2>Time series<a class="headerlink" href="#time-series" title="Permalink to this headline">¶</a></h2>
<p>pandas has simple, powerful, and efficient functionality for performing resampling operations during frequency conversion (e.g., converting secondly data into 5-minutely data). This is extremely common in, but not limited to, financial applications.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [113]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1/1/2012&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>

<span class="gp">In [114]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="gp">In [115]: </span><span class="n">ts</span>
<span class="gh">Out[115]: </span><span class="go"></span>
<span class="go">2012-01-01 00:00:00    273</span>
<span class="go">2012-01-01 00:00:01    275</span>
<span class="go">2012-01-01 00:00:02     85</span>
<span class="go">2012-01-01 00:00:03    419</span>
<span class="go">2012-01-01 00:00:04     23</span>
<span class="go">                      ... </span>
<span class="go">2012-01-01 00:01:35    451</span>
<span class="go">2012-01-01 00:01:36    176</span>
<span class="go">2012-01-01 00:01:37    209</span>
<span class="go">2012-01-01 00:01:38    451</span>
<span class="go">2012-01-01 00:01:39    361</span>
<span class="go">Freq: S, Length: 100, dtype: int64</span>

<span class="gp">In [116]: </span><span class="n">ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;5Min&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gh">Out[116]: </span><span class="go"></span>
<span class="go">2012-01-01    25328</span>
<span class="go">Freq: 5T, dtype: int64</span>
</pre></div>
</div>
<p>Time zone representation:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [117]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;3/6/2012 00:00&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>

<span class="gp">In [118]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span> <span class="n">rng</span><span class="p">)</span>

<span class="gp">In [119]: </span><span class="n">ts</span>
<span class="gh">Out[119]: </span><span class="go"></span>
<span class="go">2012-03-06    1.898833</span>
<span class="go">2012-03-07    0.346969</span>
<span class="go">2012-03-08   -1.526080</span>
<span class="go">2012-03-09   -0.051515</span>
<span class="go">2012-03-10    0.053206</span>
<span class="go">Freq: D, dtype: float64</span>

<span class="gp">In [120]: </span><span class="n">ts_utc</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)</span>

<span class="gp">In [121]: </span><span class="n">ts_utc</span>
<span class="gh">Out[121]: </span><span class="go"></span>
<span class="go">2012-03-06 00:00:00+00:00    1.898833</span>
<span class="go">2012-03-07 00:00:00+00:00    0.346969</span>
<span class="go">2012-03-08 00:00:00+00:00   -1.526080</span>
<span class="go">2012-03-09 00:00:00+00:00   -0.051515</span>
<span class="go">2012-03-10 00:00:00+00:00    0.053206</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>Converting to another time zone:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [122]: </span><span class="n">ts_utc</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s2">&quot;US/Eastern&quot;</span><span class="p">)</span>
<span class="gh">Out[122]: </span><span class="go"></span>
<span class="go">2012-03-05 19:00:00-05:00    1.898833</span>
<span class="go">2012-03-06 19:00:00-05:00    0.346969</span>
<span class="go">2012-03-07 19:00:00-05:00   -1.526080</span>
<span class="go">2012-03-08 19:00:00-05:00   -0.051515</span>
<span class="go">2012-03-09 19:00:00-05:00    0.053206</span>
<span class="go">Freq: D, dtype: float64</span>
</pre></div>
</div>
<p>Converting between time span representations:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [123]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1/1/2012&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>

<span class="gp">In [124]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="gp">In [125]: </span><span class="n">ts</span>
<span class="gh">Out[125]: </span><span class="go"></span>
<span class="go">2012-01-31   -1.263920</span>
<span class="go">2012-02-29    1.377509</span>
<span class="go">2012-03-31    0.678871</span>
<span class="go">2012-04-30   -0.567816</span>
<span class="go">2012-05-31   -0.099327</span>
<span class="go">Freq: M, dtype: float64</span>

<span class="gp">In [126]: </span><span class="n">ps</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">to_period</span><span class="p">()</span>

<span class="gp">In [127]: </span><span class="n">ps</span>
<span class="gh">Out[127]: </span><span class="go"></span>
<span class="go">2012-01   -1.263920</span>
<span class="go">2012-02    1.377509</span>
<span class="go">2012-03    0.678871</span>
<span class="go">2012-04   -0.567816</span>
<span class="go">2012-05   -0.099327</span>
<span class="go">Freq: M, dtype: float64</span>

<span class="gp">In [128]: </span><span class="n">ps</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="gh">Out[128]: </span><span class="go"></span>
<span class="go">2012-01-01   -1.263920</span>
<span class="go">2012-02-01    1.377509</span>
<span class="go">2012-03-01    0.678871</span>
<span class="go">2012-04-01   -0.567816</span>
<span class="go">2012-05-01   -0.099327</span>
<span class="go">Freq: MS, dtype: float64</span>
</pre></div>
</div>
<p>Converting between period and timestamp enables some convenient arithmetic functions to be used. In the following example, we convert a quarterly frequency with year ending in November to 9am of the end of the month following the quarter end:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [129]: </span><span class="n">prng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s2">&quot;1990Q1&quot;</span><span class="p">,</span> <span class="s2">&quot;2000Q4&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;Q-NOV&quot;</span><span class="p">)</span>

<span class="gp">In [130]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prng</span><span class="p">)),</span> <span class="n">prng</span><span class="p">)</span>

<span class="gp">In [131]: </span><span class="n">ts</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">prng</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span>

<span class="gp">In [132]: </span><span class="n">ts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[132]: </span><span class="go"></span>
<span class="go">1990-03-01 09:00   -0.500822</span>
<span class="go">1990-06-01 09:00    0.109719</span>
<span class="go">1990-09-01 09:00   -1.776095</span>
<span class="go">1990-12-01 09:00   -0.698708</span>
<span class="go">1991-03-01 09:00    1.147186</span>
<span class="go">Freq: H, dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="categoricals">
<h2>Categoricals<a class="headerlink" href="#categoricals" title="Permalink to this headline">¶</a></h2>
<p>pandas can include categorical data in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [133]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;raw_grade&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">]</span>
<span class="gp">   .....: </span>     <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>
</pre></div>
</div>
<p>Convert the raw grades to a categorical data type.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [134]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;raw_grade&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

<span class="gp">In [135]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grade&quot;</span><span class="p">]</span>
<span class="gh">Out[135]: </span><span class="go"></span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    a</span>
<span class="go">4    a</span>
<span class="go">5    e</span>
<span class="go">Name: grade, dtype: category</span>
<span class="go">Categories (3, object): [&#39;a&#39;, &#39;b&#39;, &#39;e&#39;]</span>
</pre></div>
</div>
<p>Rename the categories to more meaningful names (assigning to <code class="docutils literal notranslate"><span class="pre">Series.cat.categories</span></code> is in place!).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [136]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grade&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;very good&quot;</span><span class="p">,</span> <span class="s2">&quot;good&quot;</span><span class="p">,</span> <span class="s2">&quot;very bad&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Reorder the categories and simultaneously add the missing categories (methods under <code class="docutils literal notranslate"><span class="pre">Series.cat</span></code> return a new <code class="docutils literal notranslate"><span class="pre">Series</span></code> by default).</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [137]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;grade&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">[</span><span class="s2">&quot;very bad&quot;</span><span class="p">,</span> <span class="s2">&quot;bad&quot;</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="s2">&quot;good&quot;</span><span class="p">,</span> <span class="s2">&quot;very good&quot;</span><span class="p">]</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [138]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;grade&quot;</span><span class="p">]</span>
<span class="gh">Out[138]: </span><span class="go"></span>
<span class="go">0    very good</span>
<span class="go">1         good</span>
<span class="go">2         good</span>
<span class="go">3    very good</span>
<span class="go">4    very good</span>
<span class="go">5     very bad</span>
<span class="go">Name: grade, dtype: category</span>
<span class="go">Categories (5, object): [&#39;very bad&#39;, &#39;bad&#39;, &#39;medium&#39;, &#39;good&#39;, &#39;very good&#39;]</span>
</pre></div>
</div>
<p>Sorting is per order in the categories, not lexical order.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [139]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;grade&quot;</span><span class="p">)</span>
<span class="gh">Out[139]: </span><span class="go"></span>
<span class="go">   id raw_grade      grade</span>
<span class="go">5   6         e   very bad</span>
<span class="go">1   2         b       good</span>
<span class="go">2   3         b       good</span>
<span class="go">0   1         a  very good</span>
<span class="go">3   4         a  very good</span>
<span class="go">4   5         a  very good</span>
</pre></div>
</div>
<p>Grouping by a categorical column also shows empty categories.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [140]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;grade&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="gh">Out[140]: </span><span class="go"></span>
<span class="go">grade</span>
<span class="go">very bad     1</span>
<span class="go">bad          0</span>
<span class="go">medium       0</span>
<span class="go">good         2</span>
<span class="go">very good    3</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<p>We use the standard convention for referencing the matplotlib API:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [141]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="gp">In [142]: </span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">plt.close</span></code> method is used to <a class="reference external" href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.close.html">close</a> a figure window.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [143]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1/1/2000&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>

<span class="gp">In [144]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="gp">In [145]: </span><span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="../_images/pd_series.png" class="align-center" src="../_images/pd_series.png" />
<p>On a DataFrame, the <code class="docutils literal notranslate"><span class="pre">DataFrame.plot</span></code> method is a convenience to plot all of the columns with labels:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [146]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [147]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="gp">In [148]: </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span>

<span class="gp">In [149]: </span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>

<span class="gp">In [150]: </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/pd_df.png" class="align-center" src="../_images/pd_df.png" />
</div>
<div class="section" id="io-management">
<h2>IO Management<a class="headerlink" href="#io-management" title="Permalink to this headline">¶</a></h2>
<div class="section" id="csv">
<h3>CSV<a class="headerlink" href="#csv" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html#io-store-in-csv">Writing</a> to a csv file.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [151]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;foo.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html#io-read-csv-table">Reading</a> from a csv file.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [152]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;foo.csv&quot;</span><span class="p">)</span>
<span class="gh">Out[152]: </span><span class="go"></span>
<span class="go">     Unnamed: 0          A          B          C          D</span>
<span class="go">0    2000-01-01   2.527323   0.305213  -0.635884  -0.347075</span>
<span class="go">1    2000-01-02   0.881981  -0.248742  -0.105841  -0.843981</span>
<span class="go">2    2000-01-03   4.517202   1.219678  -1.913111  -0.381256</span>
<span class="go">3    2000-01-04   2.891130   0.716134  -2.006151  -0.512815</span>
<span class="go">4    2000-01-05   2.065124   0.872793  -2.930387   0.811646</span>
<span class="go">..          ...        ...        ...        ...        ...</span>
<span class="go">995  2002-09-22  20.791657 -32.972941  16.015710 -31.395966</span>
<span class="go">996  2002-09-23  19.692483 -33.208186  16.460410 -30.125469</span>
<span class="go">997  2002-09-24  19.096011 -32.630660  15.857046 -30.634440</span>
<span class="go">998  2002-09-25  18.712252 -32.830639  15.494404 -28.953304</span>
<span class="go">999  2002-09-26  21.340697 -32.351636  15.838692 -28.124263</span>

<span class="go">[1000 rows x 5 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="hdf5">
<h3>HDF5<a class="headerlink" href="#hdf5" title="Permalink to this headline">¶</a></h3>
<p>Reading and writing to <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html#io-hdf5">HDFStores</a>.</p>
<p>Writing to a HDF5 Store.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [153]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="s2">&quot;foo.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;df&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Reading from a HDF5 Store.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [154]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s2">&quot;foo.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;df&quot;</span><span class="p">)</span>
<span class="gh">Out[154]: </span><span class="go"></span>
<span class="go">                    A          B          C          D</span>
<span class="go">2000-01-01   2.527323   0.305213  -0.635884  -0.347075</span>
<span class="go">2000-01-02   0.881981  -0.248742  -0.105841  -0.843981</span>
<span class="go">2000-01-03   4.517202   1.219678  -1.913111  -0.381256</span>
<span class="go">2000-01-04   2.891130   0.716134  -2.006151  -0.512815</span>
<span class="go">2000-01-05   2.065124   0.872793  -2.930387   0.811646</span>
<span class="go">...               ...        ...        ...        ...</span>
<span class="go">2002-09-22  20.791657 -32.972941  16.015710 -31.395966</span>
<span class="go">2002-09-23  19.692483 -33.208186  16.460410 -30.125469</span>
<span class="go">2002-09-24  19.096011 -32.630660  15.857046 -30.634440</span>
<span class="go">2002-09-25  18.712252 -32.830639  15.494404 -28.953304</span>
<span class="go">2002-09-26  21.340697 -32.351636  15.838692 -28.124263</span>

<span class="go">[1000 rows x 4 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="excel">
<h3>Excel<a class="headerlink" href="#excel" title="Permalink to this headline">¶</a></h3>
<p>Reading and writing to <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html#io-excel">MS Excel</a>.</p>
<p>Writing to an excel file.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [155]: </span><span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;foo.xlsx&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Reading from an excel file.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [156]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;foo.xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;Sheet1&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NA&quot;</span><span class="p">])</span>
<span class="gh">Out[156]: </span><span class="go"></span>
<span class="go">    Unnamed: 0          A          B          C          D</span>
<span class="go">0   2000-01-01   2.527323   0.305213  -0.635884  -0.347075</span>
<span class="go">1   2000-01-02   0.881981  -0.248742  -0.105841  -0.843981</span>
<span class="go">2   2000-01-03   4.517202   1.219678  -1.913111  -0.381256</span>
<span class="go">3   2000-01-04   2.891130   0.716134  -2.006151  -0.512815</span>
<span class="go">4   2000-01-05   2.065124   0.872793  -2.930387   0.811646</span>
<span class="go">..         ...        ...        ...        ...        ...</span>
<span class="go">995 2002-09-22  20.791657 -32.972941  16.015710 -31.395966</span>
<span class="go">996 2002-09-23  19.692483 -33.208186  16.460410 -30.125469</span>
<span class="go">997 2002-09-24  19.096011 -32.630660  15.857046 -30.634440</span>
<span class="go">998 2002-09-25  18.712252 -32.830639  15.494404 -28.953304</span>
<span class="go">999 2002-09-26  21.340697 -32.351636  15.838692 -28.124263</span>

<span class="go">[1000 rows x 5 columns]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<p>Trim white spaces for object-dtype element.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>                               <span class="c1"># traverse each column</span>
   <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_object_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="c1"># if dtype is object</span>
      <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>            <span class="c1"># remove white space</span>
</pre></div>
</div>
<p>Data wrangling with pandas can be referenced through an official <a class="reference external" href="http://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">cheatsheet</a>.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="matlab_finance.html" title="previous page">MATLAB for Finance</a>
    <a class='right-next' id="next-link" href="scipy_guide.html" title="next page">SciPy Guide</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Yiming Dai.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>